<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Example Android: Unit Testing</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link href="data:text/css;charset=utf-8,%0Ahtml%20%7B%0Afont%2Dsize%3A%20100%25%3B%0Aoverflow%2Dy%3A%20scroll%3B%0A%2Dwebkit%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%0A%2Dms%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%0A%7D%0Abody%20%7B%0Acolor%3A%20%23444%3B%0Afont%2Dfamily%3A%20Georgia%2C%20Palatino%2C%20%27Palatino%20Linotype%27%2C%20Times%2C%20%27Times%20New%20Roman%27%2C%20serif%3B%0Afont%2Dsize%3A%2012px%3B%0Aline%2Dheight%3A%201%2E7%3B%0Apadding%3A%201em%3B%0Amargin%3A%20auto%3B%0Amax%2Dwidth%3A%2042em%3B%0Abackground%3A%20%23fefefe%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230645ad%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%230b0080%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%2306e%3B%0A%7D%0Aa%3Aactive%20%7B%0Acolor%3A%20%23faa700%3B%0A%7D%0Aa%3Afocus%20%7B%0Aoutline%3A%20thin%20dotted%3B%0A%7D%0A%2A%3A%3A%2Dmoz%2Dselection%20%7B%0Abackground%3A%20rgba%28255%2C%20255%2C%200%2C%200%2E3%29%3B%0Acolor%3A%20%23000%3B%0A%7D%0A%2A%3A%3Aselection%20%7B%0Abackground%3A%20rgba%28255%2C%20255%2C%200%2C%200%2E3%29%3B%0Acolor%3A%20%23000%3B%0A%7D%0Aa%3A%3A%2Dmoz%2Dselection%20%7B%0Abackground%3A%20rgba%28255%2C%20255%2C%200%2C%200%2E3%29%3B%0Acolor%3A%20%230645ad%3B%0A%7D%0Aa%3A%3Aselection%20%7B%0Abackground%3A%20rgba%28255%2C%20255%2C%200%2C%200%2E3%29%3B%0Acolor%3A%20%230645ad%3B%0A%7D%0Ap%20%7B%0Amargin%3A%201em%200%3B%0A%7D%0Aimg%20%7B%0Amax%2Dwidth%3A%20100%25%3B%0A%7D%0Ah1%2C%20h2%2C%20h3%2C%20h4%2C%20h5%2C%20h6%20%7B%0Acolor%3A%20%23111%3B%0Aline%2Dheight%3A%20125%25%3B%0Amargin%2Dtop%3A%202em%3B%0Afont%2Dweight%3A%20normal%3B%0A%7D%0Ah4%2C%20h5%2C%20h6%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%202%2E5em%3B%0A%7D%0Ah2%20%7B%0Afont%2Dsize%3A%202em%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%201%2E5em%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%201%2E2em%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%200%2E9em%3B%0A%7D%0Ablockquote%20%7B%0Acolor%3A%20%23666666%3B%0Amargin%3A%200%3B%0Apadding%2Dleft%3A%203em%3B%0Aborder%2Dleft%3A%200%2E5em%20%23EEE%20solid%3B%0A%7D%0Ahr%20%7B%0Adisplay%3A%20block%3B%0Aheight%3A%202px%3B%0Aborder%3A%200%3B%0Aborder%2Dtop%3A%201px%20solid%20%23aaa%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0Amargin%3A%201em%200%3B%0Apadding%3A%200%3B%0A%7D%0Apre%2C%20code%2C%20kbd%2C%20samp%20%7B%0Acolor%3A%20%23000%3B%0Afont%2Dfamily%3A%20monospace%2C%20monospace%3B%0A%5Ffont%2Dfamily%3A%20%27courier%20new%27%2C%20monospace%3B%0Afont%2Dsize%3A%200%2E98em%3B%0A%7D%0Apre%20%7B%0Awhite%2Dspace%3A%20pre%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%0Aword%2Dwrap%3A%20break%2Dword%3B%0A%7D%0Ab%2C%20strong%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Adfn%20%7B%0Afont%2Dstyle%3A%20italic%3B%0A%7D%0Ains%20%7B%0Abackground%3A%20%23ff9%3B%0Acolor%3A%20%23000%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Amark%20%7B%0Abackground%3A%20%23ff0%3B%0Acolor%3A%20%23000%3B%0Afont%2Dstyle%3A%20italic%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Asub%2C%20sup%20%7B%0Afont%2Dsize%3A%2075%25%3B%0Aline%2Dheight%3A%200%3B%0Aposition%3A%20relative%3B%0Avertical%2Dalign%3A%20baseline%3B%0A%7D%0Asup%20%7B%0Atop%3A%20%2D0%2E5em%3B%0A%7D%0Asub%20%7B%0Abottom%3A%20%2D0%2E25em%3B%0A%7D%0Aul%2C%20ol%20%7B%0Amargin%3A%201em%200%3B%0Apadding%3A%200%200%200%202em%3B%0A%7D%0Ali%20p%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Aul%20ul%2C%20ol%20ol%20%7B%0Amargin%3A%20%2E3em%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dbottom%3A%201em%3B%0A%7D%0Adt%20%7B%0Afont%2Dweight%3A%20bold%3B%0Amargin%2Dbottom%3A%20%2E8em%3B%0A%7D%0Add%20%7B%0Amargin%3A%200%200%20%2E8em%202em%3B%0A%7D%0Add%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Aimg%20%7B%0Aborder%3A%200%3B%0A%2Dms%2Dinterpolation%2Dmode%3A%20bicubic%3B%0Avertical%2Dalign%3A%20middle%3B%0A%7D%0Afigure%20%7B%0Adisplay%3A%20block%3B%0Atext%2Dalign%3A%20center%3B%0Amargin%3A%201em%200%3B%0A%7D%0Afigure%20img%20%7B%0Aborder%3A%20none%3B%0Amargin%3A%200%20auto%3B%0A%7D%0Afigcaption%20%7B%0Afont%2Dsize%3A%200%2E8em%3B%0Afont%2Dstyle%3A%20italic%3B%0Amargin%3A%200%200%20%2E8em%3B%0A%7D%0Atable%20%7B%0Amargin%2Dbottom%3A%202em%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23ddd%3B%0Aborder%2Dright%3A%201px%20solid%20%23ddd%3B%0Aborder%2Dspacing%3A%200%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Apadding%3A%20%2E2em%201em%3B%0Abackground%2Dcolor%3A%20%23eee%3B%0Aborder%2Dtop%3A%201px%20solid%20%23ddd%3B%0Aborder%2Dleft%3A%201px%20solid%20%23ddd%3B%0A%7D%0Atable%20td%20%7B%0Apadding%3A%20%2E2em%201em%3B%0Aborder%2Dtop%3A%201px%20solid%20%23ddd%3B%0Aborder%2Dleft%3A%201px%20solid%20%23ddd%3B%0Avertical%2Dalign%3A%20top%3B%0A%7D%0A%2Eauthor%20%7B%0Afont%2Dsize%3A%201%2E2em%3B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%40media%20only%20screen%20and%20%28min%2Dwidth%3A%20480px%29%20%7B%0Abody%20%7B%0Afont%2Dsize%3A%2014px%3B%0A%7D%0A%7D%0A%40media%20only%20screen%20and%20%28min%2Dwidth%3A%20768px%29%20%7B%0Abody%20%7B%0Afont%2Dsize%3A%2016px%3B%0A%7D%0A%7D%0A%40media%20print%20%7B%0A%2A%20%7B%0Abackground%3A%20transparent%20%21important%3B%0Acolor%3A%20black%20%21important%3B%0Afilter%3A%20none%20%21important%3B%0A%2Dms%2Dfilter%3A%20none%20%21important%3B%0A%7D%0Abody%20%7B%0Afont%2Dsize%3A%2012pt%3B%0Amax%2Dwidth%3A%20100%25%3B%0A%7D%0Aa%2C%20a%3Avisited%20%7B%0Atext%2Ddecoration%3A%20underline%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%201px%3B%0Aborder%3A%200%3B%0Aborder%2Dbottom%3A%201px%20solid%20black%3B%0A%7D%0Aa%5Bhref%5D%3Aafter%20%7B%0Acontent%3A%20%22%20%28%22%20attr%28href%29%20%22%29%22%3B%0A%7D%0Aabbr%5Btitle%5D%3Aafter%20%7B%0Acontent%3A%20%22%20%28%22%20attr%28title%29%20%22%29%22%3B%0A%7D%0A%2Eir%20a%3Aafter%2C%20a%5Bhref%5E%3D%22javascript%3A%22%5D%3Aafter%2C%20a%5Bhref%5E%3D%22%23%22%5D%3Aafter%20%7B%0Acontent%3A%20%22%22%3B%0A%7D%0Apre%2C%20blockquote%20%7B%0Aborder%3A%201px%20solid%20%23999%3B%0Apadding%2Dright%3A%201em%3B%0Apage%2Dbreak%2Dinside%3A%20avoid%3B%0A%7D%0Atr%2C%20img%20%7B%0Apage%2Dbreak%2Dinside%3A%20avoid%3B%0A%7D%0Aimg%20%7B%0Amax%2Dwidth%3A%20100%25%20%21important%3B%0A%7D%0A%40page%20%3Aleft%20%7B%0Amargin%3A%2015mm%2020mm%2015mm%2010mm%3B%0A%7D%0A%40page%20%3Aright%20%7B%0Amargin%3A%2015mm%2010mm%2015mm%2020mm%3B%0A%7D%0Ap%2C%20h2%2C%20h3%20%7B%0Aorphans%3A%203%3B%0Awidows%3A%203%3B%0A%7D%0Ah2%2C%20h3%20%7B%0Apage%2Dbreak%2Dafter%3A%20avoid%3B%0A%7D%0A%7D%0A" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="header">
<h1 class="title">Example Android: Unit Testing</h1>
</div>
<div id="TOC">
<ul>
<li><a href="#prerequisites"><span class="toc-section-number">1</span> Prerequisites</a></li>
<li><a href="#unit-testing"><span class="toc-section-number">2</span> Unit Testing</a><ul>
<li><a href="#testing"><span class="toc-section-number">2.1</span> Testing</a></li>
<li><a href="#preface"><span class="toc-section-number">2.2</span> Preface</a></li>
</ul></li>
<li><a href="#android-annotations"><span class="toc-section-number">3</span> Android Annotations</a><ul>
<li><a href="#android-annotations-1"><span class="toc-section-number">3.1</span> Android Annotations</a></li>
<li><a href="#annotation-processing"><span class="toc-section-number">3.2</span> Annotation Processing</a></li>
<li><a href="#how-does-it-work"><span class="toc-section-number">3.3</span> How does it work</a></li>
<li><a href="#how-do-you-use-it"><span class="toc-section-number">3.4</span> How do you use it</a></li>
<li><a href="#example-activity-and-views"><span class="toc-section-number">3.5</span> Example: Activity and Views</a></li>
<li><a href="#example-bean-and-ebean"><span class="toc-section-number">3.6</span> Example: Bean and EBean</a></li>
<li><a href="#example-background-and-uithread"><span class="toc-section-number">3.7</span> Example: Background and UIThread</a></li>
<li><a href="#android-annotations-in-gradle"><span class="toc-section-number">3.8</span> Android Annotations in Gradle</a></li>
</ul></li>
<li><a href="#mocking"><span class="toc-section-number">4</span> Mocking</a><ul>
<li><a href="#junit-and-mockito-in-gradle-also-powermock-for-overriding-private-loggers"><span class="toc-section-number">4.1</span> JUnit and Mockito in Gradle (also Powermock for overriding private loggers</a></li>
<li><a href="#robolectric"><span class="toc-section-number">4.2</span> Robolectric</a></li>
<li><a href="#unit-testing-an-activity"><span class="toc-section-number">4.3</span> Unit testing an Activity</a></li>
<li><a href="#error-method-...-not-mocked"><span class="toc-section-number">4.4</span> Error: &quot;Method ... not mocked&quot;</a></li>
<li><a href="#running-unit-tests-without-android-device"><span class="toc-section-number">4.5</span> Running unit tests without Android device</a></li>
<li><a href="#robolectric-in-gradle"><span class="toc-section-number">4.6</span> Robolectric in Gradle</a></li>
<li><a href="#test-doubles"><span class="toc-section-number">4.7</span> Test Doubles</a></li>
</ul></li>
<li><a href="#unit-vs-integration-tests"><span class="toc-section-number">5</span> Unit vs Integration Tests</a><ul>
<li><a href="#unit-vs-integration-tests-1"><span class="toc-section-number">5.1</span> Unit vs Integration Tests</a></li>
<li><a href="#drinking-mockito-when-youre-in-aa"><span class="toc-section-number">5.2</span> Drinking Mockito when you're in AA :)</a></li>
</ul></li>
<li><a href="#rest"><span class="toc-section-number">6</span> REST</a><ul>
<li><a href="#doing-rest-calls-in-android"><span class="toc-section-number">6.1</span> Doing REST calls in Android</a></li>
<li><a href="#rest-in-android-retrofit2"><span class="toc-section-number">6.2</span> REST in Android: Retrofit2</a></li>
<li><a href="#retrofit-in-gradle"><span class="toc-section-number">6.3</span> Retrofit in Gradle</a></li>
<li><a href="#retrofit-in-your-code"><span class="toc-section-number">6.4</span> Retrofit in your code</a></li>
<li><a href="#retrofit-in-your-code-1"><span class="toc-section-number">6.5</span> Retrofit in your code</a></li>
<li><a href="#retrofit-in-your-code-2"><span class="toc-section-number">6.6</span> Retrofit in your code</a></li>
<li><a href="#integration-testing-the-restdatacontroller"><span class="toc-section-number">6.7</span> Integration Testing the RestDataController</a></li>
<li><a href="#unit-testing-the-restdatacontroller"><span class="toc-section-number">6.8</span> Unit Testing the RestDataController</a></li>
</ul></li>
<li><a href="#running-tests-and-getting-test-coverage"><span class="toc-section-number">7</span> Running tests and getting test coverage</a><ul>
<li><a href="#running-tests-in-gradle"><span class="toc-section-number">7.1</span> Running tests in Gradle</a></li>
<li><a href="#getting-test-coverage-for-android-projects"><span class="toc-section-number">7.2</span> Getting test coverage for Android projects</a></li>
</ul></li>
<li><a href="#resources"><span class="toc-section-number">8</span> Resources</a></li>
</ul>
</div>
<h1 id="prerequisites"><span class="header-section-number">1</span> Prerequisites</h1>
<p>To use this example you need to install the following tools:</p>
<ul>
<li><a href="http://developer.android.com/sdk/index.html">Android Studio 2.3</a></li>
<li>The source and build files of this project :)</li>
</ul>
<hr />
<h1 id="unit-testing"><span class="header-section-number">2</span> Unit Testing</h1>
<hr />
<h2 id="testing"><span class="header-section-number">2.1</span> Testing</h2>
<p>For testing Android apps, you typically create <a href="https://developer.android.com/training/testing/unit-testing/index.html">these types of automated unit tests</a>:</p>
<ul>
<li>Local tests: Unit tests that run on your local machine only. These tests are compiled to run locally on the Java Virtual Machine (JVM) to minimize execution time. Use this approach to run unit tests that have no dependencies on the Android framework or have dependencies that can be filled by using mock objects.</li>
</ul>
<hr />
<ul>
<li>Instrumented tests: Unit tests that run on an Android device or emulator. These tests have access to instrumentation information, such as the Context for the app under test. Use this approach to run unit tests that have Android dependencies which cannot be easily filled by using mock objects.</li>
</ul>
<hr />
<h2 id="preface"><span class="header-section-number">2.2</span> Preface</h2>
<p>Suppose you want to build an Android application in a TDD-style. There are a few nasty things about Android that makes unit testing more difficult than for normal Java applications.</p>
<hr />
<ul>
<li>Android source code is Java but it is compiled by the Dalvik compiler to dex. To run it you need an Android device or emulator.</li>
<li>In a standard Android Application the Android API is everywhere in your code. The Android code is already tested so to only test <em>your</em> application we need to leave Android code outside scope as much as possible. For me <em>unit testing</em> means testing <em>my</em> code apart from the framework (I consider Android as a library and a <a href="https://martinfowler.com/bliki/InversionOfControl.html">framework</a>).</li>
</ul>
<hr />
<p>This codebase uses a few libraries to simplify unit testing for Android applications:</p>
<ul>
<li>Android Annotations (if you need more power and be able to handle more complex situations consider ButterKnife for UI binding and Dagger 2 for dependency injections, AA does both)</li>
<li>Robolectric</li>
</ul>
<hr />
<p>There are also good design and architecture choices to make that simplify unit testing but this example focuses on a simple application and some libraries. Some resources that might help to improve the design of your Android application are:</p>
<ul>
<li><a href="https://github.com/android10/Android-CleanArchitecture">Android Clean Architecture</a></li>
<li><a href="https://www.youtube.com/watch?v=bXRI7YAha1M">Effective Android Architecture</a></li>
</ul>
<hr />
<h1 id="android-annotations"><span class="header-section-number">3</span> Android Annotations</h1>
<hr />
<h2 id="android-annotations-1"><span class="header-section-number">3.1</span> Android Annotations</h2>
<ul>
<li>AndroidAnnotations is an Open Source annotation processing library that speeds up Android development</li>
<li>It takes care of the plumbing, and lets you concentrate on what's really important.</li>
<li>By simplifying your code, it facilitates its maintenance.</li>
</ul>
<hr />
<h2 id="annotation-processing"><span class="header-section-number">3.2</span> Annotation Processing</h2>
<ul>
<li>Annotation Processing is a feature of the Java compiler that lets you write a library to process source code annotations at compile time</li>
<li>Runs your annotation processing code in the compiler and can generate new source code files that will also be compiled</li>
<li>There is no way with public API to modify existing classes</li>
</ul>
<hr />
<h2 id="how-does-it-work"><span class="header-section-number">3.3</span> How does it work</h2>
<ul>
<li>AndroidAnnotations is a Java Annotation Processing Tool that generates Android specific source code based on annotations</li>
<li>It enhances a class by subclassing it with a generated class that adds and overrides methods in the annotated class</li>
<li>The generated class is named by appending an underscore to the name of the annotated class</li>
</ul>
<hr />
<h2 id="how-do-you-use-it"><span class="header-section-number">3.4</span> How do you use it</h2>
<p>Everywhere in the project that you refer to an enhanced class you append an underscore to the class name:</p>
<ul>
<li>In the Android Manifest</li>
<li>In layout resources</li>
<li>In the code, even in your test code</li>
</ul>
<hr />
<h2 id="example-activity-and-views"><span class="header-section-number">3.5</span> Example: Activity and Views</h2>
<div class="sourceCode" include="src/main/java/com/example/activity/DeckardActivity.java" start="15" stop="22"><pre class="sourceCode java"><code class="sourceCode java"><span class="fu">@EActivity</span>(R.<span class="fu">layout</span>.<span class="fu">deckard</span>)
<span class="kw">public</span> <span class="kw">class</span> DeckardActivity <span class="kw">extends</span> Activity {
    <span class="fu">@ViewById</span>(R.<span class="fu">id</span>.<span class="fu">button</span>)
    Button button;

    <span class="fu">@ViewById</span>(R.<span class="fu">id</span>.<span class="fu">editText</span>)
    TextView editText;
</code></pre></div>
<div class="sourceCode" include="src/main/java/com/example/activity/DeckardActivity.java" start="37" stop="37"><pre class="sourceCode java"><code class="sourceCode java">}</code></pre></div>
<hr />
<h2 id="example-bean-and-ebean"><span class="header-section-number">3.6</span> Example: Bean and EBean</h2>
<div class="sourceCode" include="src/main/java/com/example/activity/DeckardActivity.java" start="15" stop="16"><pre class="sourceCode java"><code class="sourceCode java"><span class="fu">@EActivity</span>(R.<span class="fu">layout</span>.<span class="fu">deckard</span>)
<span class="kw">public</span> <span class="kw">class</span> DeckardActivity <span class="kw">extends</span> Activity {</code></pre></div>
<div class="sourceCode" include="src/main/java/com/example/activity/DeckardActivity.java" start="22" stop="37"><pre class="sourceCode java"><code class="sourceCode java">
    <span class="fu">@Bean</span>(ButtonClickListener.<span class="fu">class</span>)
    IButtonClickListener buttonClickHandler;

    <span class="fu">@Override</span>
    <span class="kw">protected</span> <span class="dt">void</span> <span class="fu">onCreate</span>(Bundle savedInstanceState) {
        <span class="kw">super</span>.<span class="fu">onCreate</span>(savedInstanceState);
    }

    <span class="fu">@AfterViews</span>
    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">afterCreate</span>()
    {
        buttonClickHandler.<span class="fu">setActivity</span>(<span class="kw">this</span>);
        button.<span class="fu">setOnClickListener</span>(buttonClickHandler);
    }
}</code></pre></div>
<hr />
<h2 id="example-background-and-uithread"><span class="header-section-number">3.7</span> Example: Background and UIThread</h2>
<div class="sourceCode" include="src/main/java/com/example/activity/ButtonClickListener.java" start="13" stop="42"><pre class="sourceCode java"><code class="sourceCode java"><span class="fu">@EBean</span>
<span class="kw">class</span> ButtonClickListener <span class="kw">implements</span> IButtonClickListener {
    <span class="kw">private</span> DeckardActivity activity;
    <span class="kw">private</span> IDataController dataController;

    <span class="fu">@Bean</span>(RestDataController.<span class="fu">class</span>)
    <span class="dt">void</span> <span class="fu">setDataController</span>(IDataController dataController){
        <span class="kw">this</span>.<span class="fu">dataController</span> = dataController;
    }

    <span class="fu">@Override</span>
    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">onClick</span>(View view) {
        <span class="fu">getAsyncComment</span>();
    }

    <span class="fu">@Background</span>
    <span class="dt">void</span> <span class="fu">getAsyncComment</span>() {
        <span class="fu">updateTextField</span>(dataController.<span class="fu">getData</span>());
    }

    <span class="fu">@UiThread</span>
    <span class="dt">void</span> <span class="fu">updateTextField</span>(String data) {
        EditText editText = activity.<span class="fu">findViewById</span>(R.<span class="fu">id</span>.<span class="fu">editText</span>);
        editText.<span class="fu">setText</span>(data);
    }

    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">setActivity</span>(DeckardActivity activity) {
        <span class="kw">this</span>.<span class="fu">activity</span> = activity;
    }
}</code></pre></div>
<hr />
<h2 id="android-annotations-in-gradle"><span class="header-section-number">3.8</span> Android Annotations in Gradle</h2>
<div class="sourceCode" include="build.gradle" start="66" stop="68"><pre class="sourceCode yaml"><code class="sourceCode yaml">dependencies <span class="kw">{</span>
    <span class="fu">implementation &quot;org.androidannotations:</span>androidannotations-api:4.4.0&quot;
    annotationProcessor &quot;org.androidannotations:androidannotations:4.4.0&quot;</code></pre></div>
<div class="sourceCode" include="build.gradle" start="79" stop="79"><pre class="sourceCode yaml"><code class="sourceCode yaml">}</code></pre></div>
<hr />
<h1 id="mocking"><span class="header-section-number">4</span> Mocking</h1>
<hr />
<h2 id="junit-and-mockito-in-gradle-also-powermock-for-overriding-private-loggers"><span class="header-section-number">4.1</span> JUnit and Mockito in Gradle (also Powermock for overriding private loggers</h2>
<p>Just like in Maven:</p>
<div class="sourceCode" include="build.gradle" start="66" stop="66"><pre class="sourceCode yaml"><code class="sourceCode yaml">dependencies <span class="kw">{</span></code></pre></div>
<div class="sourceCode" include="build.gradle" start="76" stop="79"><pre class="sourceCode yaml"><code class="sourceCode yaml">    <span class="fu">testImplementation 'org.mockito:</span>mockito-core:2.3.0'
    <span class="fu">testImplementation 'org.powermock:</span>powermock-api-mockito2:1.7.3'
    <span class="fu">testImplementation 'org.robolectric:</span>robolectric:3.5.1'
}</code></pre></div>
<hr />
<h2 id="robolectric"><span class="header-section-number">4.2</span> Robolectric</h2>
<p>Running tests on an Android emulator or device is slow! Building, deploying, and launching the app often takes a minute or more. That’s no way to do TDD. There must be a better way.</p>
<hr />
<h2 id="unit-testing-an-activity"><span class="header-section-number">4.3</span> Unit testing an Activity</h2>
<p>Suppose you want to unit test and activity. You try this:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> DeckardActivityIntegrationTest {

    <span class="fu">@Test</span>
    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">whenActivityCreatedAppDependenciesAreSetup</span>() <span class="kw">throws</span> Exception {
        DeckardActivity deckardActivity = <span class="kw">new</span> <span class="fu">DeckardActivity</span>();
        <span class="fu">assertNotNull</span>(deckardActivity.<span class="fu">buttonClickHandler</span>);
    }
}</code></pre></div>
<p>When you run this test, the console says: <a href="https://developer.android.com/training/testing/unit-testing/local-unit-tests.html">&quot;Error: 'Method ... not mocked'&quot;</a></p>
<hr />
<h2 id="error-method-...-not-mocked"><span class="header-section-number">4.4</span> Error: &quot;Method ... not mocked&quot;</h2>
<p>If you run a test that calls an API from the Android SDK that you do not mock, you'll receive an error that says this method is not mocked. That's because the android.jar file used to run unit tests does not contain any actual code (those APIs are provided only by the Android system image on a device). Instead, all methods throw exceptions by default, this behaviour can be stopped however:</p>
<div class="sourceCode" include="build.gradle" start="42" stop="48"><pre class="sourceCode yaml"><code class="sourceCode yaml">    testOptions <span class="kw">{</span>
        unitTests {
            includeAndroidResources = true
            returnDefaultValues = true
        <span class="kw">}</span>

    }</code></pre></div>
<hr />
<h2 id="running-unit-tests-without-android-device"><span class="header-section-number">4.5</span> Running unit tests without Android device</h2>
<p><a href="http://robolectric.org/">Robolectric</a> is a unit test framework that de-fangs the Android SDK jar so you can test-drive the development of your Android app. Tests run inside the JVM on your workstation in seconds. With Robolectric and Android Annotations you can write tests like this:</p>
<hr />
<div class="sourceCode" include="src/test/java/com/example/activity/DeckardActivityIntegrationTest.java" start="10" stop="18"><pre class="sourceCode java"><code class="sourceCode java"><span class="fu">@RunWith</span>(RobolectricTestRunner.<span class="fu">class</span>)
<span class="kw">public</span> <span class="kw">class</span> DeckardActivityIntegrationTest {

    <span class="fu">@Test</span>
    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">whenActivityCreatedAppDependenciesAreSetup</span>() <span class="kw">throws</span> Exception {
        DeckardActivity_ deckardActivity = Robolectric.<span class="fu">setupActivity</span>(DeckardActivity_.<span class="fu">class</span>);
        <span class="fu">assertNotNull</span>(deckardActivity.<span class="fu">buttonClickHandler</span>);
    }
}</code></pre></div>
<hr />
<h2 id="robolectric-in-gradle"><span class="header-section-number">4.6</span> Robolectric in Gradle</h2>
<div class="sourceCode" include="build.gradle" start="66" stop="66"><pre class="sourceCode yaml"><code class="sourceCode yaml">dependencies <span class="kw">{</span></code></pre></div>
<div class="sourceCode" include="build.gradle" start="78" stop="79"><pre class="sourceCode yaml"><code class="sourceCode yaml">    <span class="fu">testImplementation 'org.robolectric:</span>robolectric:3.5.1'
}</code></pre></div>
<hr />
<p>Noticed the _ after DeckardActivity? This is the version that comes from Android Annotations (AA) annotation processor. When you use this version all annotations like <span class="citation">@Activity</span> and <span class="citation">@Bean</span> are resolved. Decide per test cases if you need the real dependencies for <span class="citation">@Bean</span> or override the properties with test doubles like stubs or mocks.</p>
<hr />
<h2 id="test-doubles"><span class="header-section-number">4.7</span> Test Doubles</h2>
<div class="figure">
<img src="data:image/gif;base64,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" alt="Figure 1: Different Test Doubles" />
<p class="caption">Figure 1: Different Test Doubles</p>
</div>
<hr />
<h1 id="unit-vs-integration-tests"><span class="header-section-number">5</span> Unit vs Integration Tests</h1>
<hr />
<h2 id="unit-vs-integration-tests-1"><span class="header-section-number">5.1</span> Unit vs Integration Tests</h2>
<p>The DeckardActivityIntegrationTest used the real dependency on RestDataController so it is in fact an integration test. We can also make a unit test for this class:</p>
<div class="sourceCode" include="src/test/java/com/example/activity/DeckardActivityTest.java" start="15" stop="34"><pre class="sourceCode java"><code class="sourceCode java"><span class="fu">@RunWith</span>(MockitoJUnitRunner.<span class="fu">class</span>)
<span class="kw">public</span> <span class="kw">class</span> DeckardActivityTest {
    <span class="fu">@Mock</span>
    Button button;

    <span class="fu">@Mock</span>
    ButtonClickListener buttonClickListener;

    <span class="fu">@Test</span>
    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">whenActivityCreatedAppDependenciesAreSetup</span>() <span class="kw">throws</span> Exception {
        DeckardActivity deckardActivity = <span class="kw">new</span> <span class="fu">DeckardActivity</span>();
        deckardActivity.<span class="fu">button</span> = button;
        deckardActivity.<span class="fu">buttonClickHandler</span> = buttonClickListener;
        deckardActivity.<span class="fu">onCreate</span>(<span class="kw">null</span>);
        deckardActivity.<span class="fu">afterCreate</span>();

        <span class="fu">verify</span>(buttonClickListener).<span class="fu">setActivity</span>(deckardActivity);
        <span class="fu">verify</span>(button).<span class="fu">setOnClickListener</span>(buttonClickListener);
    }
}</code></pre></div>
<hr />
<p>Let's look at another class that we can unit test:</p>
<div class="sourceCode" include="src/main/java/com/example/activity/ButtonClickListener.java" start="13" stop="42"><pre class="sourceCode java"><code class="sourceCode java"><span class="fu">@EBean</span>
<span class="kw">class</span> ButtonClickListener <span class="kw">implements</span> IButtonClickListener {
    <span class="kw">private</span> DeckardActivity activity;
    <span class="kw">private</span> IDataController dataController;

    <span class="fu">@Bean</span>(RestDataController.<span class="fu">class</span>)
    <span class="dt">void</span> <span class="fu">setDataController</span>(IDataController dataController){
        <span class="kw">this</span>.<span class="fu">dataController</span> = dataController;
    }

    <span class="fu">@Override</span>
    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">onClick</span>(View view) {
        <span class="fu">getAsyncComment</span>();
    }

    <span class="fu">@Background</span>
    <span class="dt">void</span> <span class="fu">getAsyncComment</span>() {
        <span class="fu">updateTextField</span>(dataController.<span class="fu">getData</span>());
    }

    <span class="fu">@UiThread</span>
    <span class="dt">void</span> <span class="fu">updateTextField</span>(String data) {
        EditText editText = activity.<span class="fu">findViewById</span>(R.<span class="fu">id</span>.<span class="fu">editText</span>);
        editText.<span class="fu">setText</span>(data);
    }

    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">setActivity</span>(DeckardActivity activity) {
        <span class="kw">this</span>.<span class="fu">activity</span> = activity;
    }
}</code></pre></div>
<hr />
<p>The ButtonClickListener had two dependencies:</p>
<ul>
<li>The DeckardActivity</li>
<li>The RestDataController</li>
</ul>
<p>Both dependencies can be mocked:</p>
<hr />
<h2 id="drinking-mockito-when-youre-in-aa"><span class="header-section-number">5.2</span> Drinking Mockito when you're in AA :)</h2>
<div class="sourceCode" include="src/test/java/com/example/activity/ButtonClickListenerTest.java" start="16" stop="43"><pre class="sourceCode java"><code class="sourceCode java"><span class="fu">@RunWith</span>(org.<span class="fu">mockito</span>.<span class="fu">junit</span>.<span class="fu">MockitoJUnitRunner</span>.<span class="fu">class</span>)
<span class="kw">public</span> <span class="kw">class</span> ButtonClickListenerTest {
    <span class="fu">@Mock</span>
    DeckardActivity deckardActivity;

    <span class="fu">@Mock</span>
    IDataController dataController;

    <span class="fu">@InjectMocks</span>
    ButtonClickListener buttonClickListener;

    <span class="fu">@Mock</span>
    EditText editText;

    <span class="fu">@Mock</span>
    View eventSource;

    <span class="fu">@Test</span>
    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">whenButtonClickedTheEditTextContainsHelloOOSE</span>()
    {
        <span class="fu">when</span>(deckardActivity.<span class="fu">findViewById</span>(R.<span class="fu">id</span>.<span class="fu">editText</span>)).<span class="fu">thenReturn</span>(editText);
        <span class="fu">when</span>(dataController.<span class="fu">getData</span>()).<span class="fu">thenReturn</span>(<span class="st">&quot;Hello OOSE&quot;</span>);
        buttonClickListener.<span class="fu">setActivity</span>(deckardActivity);
        buttonClickListener.<span class="fu">setDataController</span>(dataController);
        buttonClickListener.<span class="fu">onClick</span>(eventSource);
        <span class="fu">verify</span>(editText).<span class="fu">setText</span>(<span class="st">&quot;Hello OOSE&quot;</span>);
    }
}</code></pre></div>
<hr />
<h1 id="rest"><span class="header-section-number">6</span> REST</h1>
<hr />
<h2 id="doing-rest-calls-in-android"><span class="header-section-number">6.1</span> Doing REST calls in Android</h2>
<p>We saw the RestDataController as a dependency for the ButtonClickListener, but how to do REST calls from an Android device?</p>
<p>There are two things things to consider:</p>
<ul>
<li>Android does not allow you to access services on the main thread, luckily AA has <span class="citation">@Background</span> and <span class="citation">@UIThread</span> (but you can do this with standard Android <a href="https://developer.android.com/guide/components/processes-and-threads.html">too</a>)</li>
<li>You need to alter the AndroidManifest.xml:</li>
</ul>
<div class="sourceCode" include="src/main/AndroidManifest.xml" start="15" stop="15"><pre class="sourceCode xml"><code class="sourceCode xml">    <span class="kw">&lt;uses-permission</span><span class="ot"> android:name=</span><span class="st">&quot;android.permission.INTERNET&quot;</span><span class="kw">/&gt;</span></code></pre></div>
<hr />
<h2 id="rest-in-android-retrofit2"><span class="header-section-number">6.2</span> REST in Android: Retrofit2</h2>
<p>There are different options/APIs to do REST calls:</p>
<ul>
<li>JAX-RS Client, like Jersey. Heavyweight, has an own DI container (HK2) built on Guice.</li>
<li>Spring RestTemplate (or use AA's annotation to access this template). Can cause dependency problems with HTTP Commons.</li>
<li>Use Retrofit2, this is my favourite.</li>
</ul>
<hr />
<h2 id="retrofit-in-gradle"><span class="header-section-number">6.3</span> Retrofit in Gradle</h2>
<div class="sourceCode" include="build.gradle" start="66" stop="66"><pre class="sourceCode yaml"><code class="sourceCode yaml">dependencies <span class="kw">{</span></code></pre></div>
<div class="sourceCode" include="build.gradle" start="71" stop="72"><pre class="sourceCode yaml"><code class="sourceCode yaml">    <span class="fu">implementation 'com.squareup.retrofit2:</span>retrofit:2.1.0'
    <span class="fu">implementation 'com.squareup.retrofit2:</span>converter-gson:2.1.0'</code></pre></div>
<div class="sourceCode" include="build.gradle" start="79" stop="79"><pre class="sourceCode yaml"><code class="sourceCode yaml">}</code></pre></div>
<hr />
<h2 id="retrofit-in-your-code"><span class="header-section-number">6.4</span> Retrofit in your code</h2>
<p>With Retrofit the REST interface is mapped to a Java interface like this:</p>
<div class="sourceCode" include="src/main/java/com/example/activity/JsonPlaceHolderAPI.java" start="8" stop="13"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">interface</span> JsonPlaceHolderAPI {
    <span class="fu">@GET</span>(<span class="st">&quot;comments/{id}&quot;</span>)
    Call&lt;Comment&gt; <span class="fu">getComments</span>(<span class="fu">@Path</span>(<span class="st">&quot;id&quot;</span>) <span class="dt">int</span> id);
}</code></pre></div>
<hr />
<h2 id="retrofit-in-your-code-1"><span class="header-section-number">6.5</span> Retrofit in your code</h2>
<p>Using the Retrofit Builder and a JSON Mapper we can offer a simple Java interface to a client:</p>
<div class="sourceCode" include="src/main/java/com/example/activity/RetrofitBuilder.java" start="11" stop="21"><pre class="sourceCode java"><code class="sourceCode java"><span class="fu">@EBean</span>
<span class="kw">class</span> RetrofitBuilder {
    <span class="kw">private</span> <span class="dt">final</span> <span class="dt">static</span> String BASE_URL = <span class="st">&quot;https://jsonplaceholder.typicode.com/&quot;</span>;

    <span class="kw">public</span> JsonPlaceHolderAPI <span class="fu">create</span>(Class&lt;JsonPlaceHolderAPI&gt; apiClass) {
        Gson gson = <span class="kw">new</span> <span class="fu">GsonBuilder</span>().<span class="fu">setLenient</span>().<span class="fu">create</span>();
        <span class="kw">return</span> <span class="kw">new</span> Retrofit.<span class="fu">Builder</span>().<span class="fu">baseUrl</span>(BASE_URL).
                <span class="fu">addConverterFactory</span>(
                        GsonConverterFactory.<span class="fu">create</span>(gson)).<span class="fu">build</span>().<span class="fu">create</span>(apiClass);
    }
}</code></pre></div>
<hr />
<h2 id="retrofit-in-your-code-2"><span class="header-section-number">6.6</span> Retrofit in your code</h2>
<p>And the client can use the interface to call methods just like it's a local method invocation:</p>
<div class="sourceCode" include="src/main/java/com/example/activity/RestDataController.java" start="11" stop="29"><pre class="sourceCode java"><code class="sourceCode java"><span class="fu">@EBean</span>
<span class="kw">public</span> <span class="kw">class</span> RestDataController <span class="kw">implements</span> IDataController {
    <span class="kw">private</span> <span class="dt">final</span> <span class="dt">static</span> Logger logger = Logger.<span class="fu">getLogger</span>(RestDataController.<span class="fu">class</span>.<span class="fu">getName</span>());

    <span class="fu">@Bean</span>
    RetrofitBuilder retrofitBuilder;

    <span class="fu">@Override</span>
    <span class="kw">public</span> String <span class="fu">getData</span>() {
        <span class="kw">try</span> {
            <span class="kw">return</span> retrofitBuilder.<span class="fu">create</span>(JsonPlaceHolderAPI.<span class="fu">class</span>).
                    <span class="fu">getComments</span>(<span class="dv">1</span>).<span class="fu">execute</span>().<span class="fu">body</span>().<span class="fu">getBody</span>();
        } <span class="kw">catch</span> (IOException e) {
            logger.<span class="fu">log</span>(Level.<span class="fu">SEVERE</span>, e.<span class="fu">getMessage</span>());
        }
        <span class="kw">return</span> <span class="kw">null</span>;
    }
}</code></pre></div>
<hr />
<h2 id="integration-testing-the-restdatacontroller"><span class="header-section-number">6.7</span> Integration Testing the RestDataController</h2>
<p>To see if the RestDataController really gets the data from our API we can create a simple integration test. We don't need Robolectric here because there are no Android API dependencies to shadow:</p>
<div class="sourceCode" include="src/test/java/com/example/activity/RestDataControllerIntegrationTest.java" start="7" stop="14"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> RestDataControllerIntegrationTest {
    <span class="fu">@Test</span>
    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">whenFirstCommentIsRequestedItShouldStartWithLaudantium</span>()
    {
        RestDataController_ restDataController = RestDataController_.<span class="fu">getInstance_</span>(<span class="kw">null</span>);
        <span class="fu">assertTrue</span>(restDataController.<span class="fu">getData</span>().<span class="fu">startsWith</span>(<span class="st">&quot;laudantium&quot;</span>));
    }
}</code></pre></div>
<hr />
<h2 id="unit-testing-the-restdatacontroller"><span class="header-section-number">6.8</span> Unit Testing the RestDataController</h2>
<p>To see if the RestDataController works nicely with the RetrofitBuilder:</p>
<div class="sourceCode" include="src/test/java/com/example/activity/RestDataControllerTest.java" start="18" stop="45"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">import static org.mockito.Mockito.verify;</span>
<span class="kw">import static org.mockito.Mockito.when;</span>

<span class="fu">@RunWith</span>(MockitoJUnitRunner.<span class="fu">class</span>)
<span class="kw">public</span> <span class="kw">class</span> RestDataControllerTest {
    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> String MESSAGE = <span class="st">&quot;message&quot;</span>;
    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> String BODY = <span class="st">&quot;body&quot;</span>;

    <span class="fu">@Mock</span>
    RetrofitBuilder retrofitBuilder;

    <span class="fu">@Mock</span>
    Logger logger;

    <span class="fu">@Mock</span>
    JsonPlaceHolderAPI jsonPlaceHolderAPI;

    <span class="fu">@Mock</span>
    Call&lt;Comment&gt; commentCall;

    <span class="fu">@Test</span>
    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">whenExceptionIsThrownItsMessageGetsLogged</span>() <span class="kw">throws</span> IOException {
        RestDataController restDataController = <span class="kw">new</span> <span class="fu">RestDataController</span>();
        restDataController.<span class="fu">retrofitBuilder</span> = retrofitBuilder;
        <span class="fu">when</span>(retrofitBuilder.<span class="fu">create</span>(JsonPlaceHolderAPI.<span class="fu">class</span>)).<span class="fu">thenReturn</span>(jsonPlaceHolderAPI);
        <span class="fu">when</span>(jsonPlaceHolderAPI.<span class="fu">getComments</span>(<span class="dv">1</span>)).<span class="fu">thenReturn</span>(commentCall);
        <span class="fu">when</span>(commentCall.<span class="fu">execute</span>()).<span class="fu">thenThrow</span>(<span class="kw">new</span> IOException(MESSAGE));
        Whitebox.<span class="fu">setInternalState</span>(RestDataController.<span class="fu">class</span>, <span class="st">&quot;logger&quot;</span>, logger);</code></pre></div>
<hr />
<h1 id="running-tests-and-getting-test-coverage"><span class="header-section-number">7</span> Running tests and getting test coverage</h1>
<hr />
<h2 id="running-tests-in-gradle"><span class="header-section-number">7.1</span> Running tests in Gradle</h2>
<div class="sourceCode"><pre class="sourceCode yaml"><code class="sourceCode yaml">./gradlew test</code></pre></div>
<hr />
<h2 id="getting-test-coverage-for-android-projects"><span class="header-section-number">7.2</span> Getting test coverage for Android projects</h2>
<p>Jacoco is a tool for Java application that is able to generate a test coverage file that can be read by SonarQube. We need the following adjustments to build.gradle:</p>
<div class="sourceCode" include="build.gradle" start="21" stop="21"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span class="fu">apply plugin:</span> <span class="st">'jacoco'</span></code></pre></div>
<div class="sourceCode" include="build.gradle" start="36" stop="40"><pre class="sourceCode yaml"><code class="sourceCode yaml">    buildTypes <span class="kw">{</span>
        debug {
            testCoverageEnabled true
        <span class="kw">}</span>
    }</code></pre></div>
<hr />
<div class="sourceCode" include="build.gradle" start="81" stop="105"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span class="fu">task createTestReports(type:</span> JacocoReport, dependsOn: ['testDevDebugUnitTest', 'createDevDebugCoverageReport']) {
    group = <span class="st">&quot;Reporting&quot;</span>

    reports <span class="kw">{</span>
        xml.enabled = true
        html.enabled = true
    <span class="kw">}</span>

    def fileFilter = <span class="kw">[</span><span class="st">'**/R.class'</span><span class="kw">,</span>
                      <span class="st">'**/R$*.class'</span><span class="kw">,</span>
                      <span class="st">'**/BuildConfig.*'</span><span class="kw">,</span>
                      <span class="st">'**/*$ViewInjector*.*'</span><span class="kw">,</span>
                      <span class="st">'**/*$ViewBinder*.*'</span><span class="kw">,</span>
                      <span class="st">'**/*$MembersInjector*.*'</span><span class="kw">,</span>
                      <span class="st">'**/Manifest*.*'</span><span class="kw">,</span>
                      <span class="st">'**/*Test*.*'</span><span class="kw">,</span>
                      <span class="st">'android/**/*.*'</span><span class="kw">]</span>
    <span class="fu">def debugTree = fileTree(dir:</span> <span class="st">&quot;${buildDir}/intermediates/classes/debug&quot;</span><span class="er">, excludes: fileFilter)</span>
    def mainSrc = <span class="st">&quot;${project.projectDir}/src/main/java&quot;</span>

    sourceDirectories = files(<span class="kw">[</span>mainSrc<span class="kw">]</span>)
    classDirectories = files(<span class="kw">[</span>debugTree<span class="kw">]</span>)

    executionData = files(<span class="st">&quot;${project.buildDir}/jacoco/testDebugUnitTest.exec&quot;</span>)
}</code></pre></div>
<h1 id="resources"><span class="header-section-number">8</span> Resources</h1>
<ul>
<li><a href="https://developer.android.com/training/testing/unit-testing/local-unit-tests.html">Building Local Tests</a></li>
<li><a href="https://developer.android.com/training/testing/unit-testing/index.html">Building Effective Unit Tests</a></li>
<li><a href="https://github.com/androidannotations/androidannotations/wiki/Unit-test-your-application">Unit Test your Application</a></li>
<li><a href="https://github.com/androidannotations/androidannotations/wiki/Cookbook">Android Annotations Cookbook</a></li>
</ul>
</body>
</html>
